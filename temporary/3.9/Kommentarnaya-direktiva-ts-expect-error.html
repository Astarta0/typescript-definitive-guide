<p>Поскольку разработка на языке <code class="inline-code">TypeScript</code> неразрывно связанна с <code class="inline-code">JavaScript</code> в некоторых моментах может возникать разногласия.</p>
<p>Представьте ситуацию при которой необходимо покрыть тестами функцию принимающую на вход строковой параметр и кроме того выполняющей в своем теле его валидацию времени выполнения.</p>
<pre><code class="hljs language-typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isStringAssert</span>(<span class="hljs-params">valid:<span class="hljs-built_in">boolean</span></span>): <span class="hljs-title">asserts</span> <span class="hljs-title">valid</span> </span>{
    <span class="hljs-keyword">if</span>(!valid){
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`...`</span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>)</span>{
    isStringAssert(<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"string"</span>); <span class="hljs-comment">// валидация времени выполнения</span>

    <span class="hljs-comment">// некоторый код...</span>
}</code></pre>
<p>Поскольку лучшие практики тестирования предполагают написание таких тестов которые по своей природе не должны пройти, тестировщик пишуший тесты также на <code class="inline-code">TypeScript</code> при попытке протестировать ошибку время выполнения (<code class="inline-code">assert</code>) столкнется с проблемой время компиляции, так как компилятор не позволит скомпилировать код выявив несоответствие типов.</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// файл .ts</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isStringAssert</span>(<span class="hljs-params">valid:<span class="hljs-built_in">boolean</span></span>): <span class="hljs-title">asserts</span> <span class="hljs-title">valid</span> </span>{
    <span class="hljs-keyword">if</span>(!valid){
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`...`</span>);
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>)</span>{
    isStringAssert(<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"string"</span>); <span class="hljs-comment">// валидация времени выполнения</span>

    <span class="hljs-comment">// некоторый код...</span>
}

<span class="hljs-comment">// ...где-то в .ts.spec</span>

<span class="hljs-comment">/**
 * [error] Argument of type '5' is not assignable to parameter of type 'string'.
 * Компилятор TypeScript не позволяет скомпилировать код имеющий ошибки вызванные
 * несоответствие типов и тем самым препятствует тестированию кода времени выполнения.
 */</span>
action(<span class="hljs-number">5</span>);</code></pre>
<p>Чтобы разрешить сложившуюся ситуацию начиная с текущей версии была введена комемнтарная директива <code class="inline-code">// @ts-expect-error</code>.
Новая комментарная директива затавляет компилятор подовлять сообщение об ошибке в случае её возникновения, но при отсутствии необходимости сама становится её причиной.</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// @ts-expect-error</span>
action(<span class="hljs-number">5</span>); <span class="hljs-comment">// Ok!</span>
<span class="hljs-comment">// @ts-expect-error</span>
action(<span class="hljs-string">'5'</span>); <span class="hljs-comment">// Error! Unused '@ts-expect-error' directive.</span></code></pre>
